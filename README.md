# 🎴 大ピンチかるた読み上げ

iPhone/Safari対応のかるた読み上げWebアプリです。スマートフォン上で札をランダム順に音声で読み上げ、文字でも表示します。
ブラウザだけで動作するため、アプリのインストールは不要です。

## 特徴

- 📱 **スマホ最適化**: iPhone/Safariで使いやすいUI
- 🔊 **自動読み上げ**: ブラウザ標準の読み上げ機能を使用（アクセント調整済み）
- 🎯 **ランダム出題**: 重複なしでランダムに読み上げ
- ⚙️ **柔軟な設定**: 範囲選択、読み上げ間隔、速度（1.2倍速デフォルト）などを調整可能
- 📴 **オフライン対応**: PWA技術（Service Worker）により、一度読み込めばオフラインでも動作可能（※実装状況による）

## 使い方

### 1. セット選択/設定画面

1. **札の範囲選択**
   - プリセット（1-50, 51-100, 1-100）から選択
   - またはカスタム範囲を入力（開始番号・終了番号）
   
2. **読み上げ設定**
   - 読み上げ間隔：1秒 / 2秒 / 3秒（デフォルト：2秒）
   - 読み上げ回数：1回 / 2回（デフォルト：2回）
   - 読み上げ速度：0.5x 〜 2.0x（デフォルト：1.2x）

3. **開始ボタン**をタップしてゲーム開始

### 2. プレイ画面

- **札表示**：頭文字（大）、内容、大ピンチレベルが表示されます
- **自動読み上げ**：設定した回数・間隔で読み上げが行われます
  - 読み上げテキスト：「内容（スペース除去）→ 大ピンチレベル{数字}」

**操作ボタン：**
- **次へ**：読み上げ途中でも即停止して次の札へ
- **もう一回**：同じ札を1回だけ読み上げ（設定回数とは独立）
- **終了**：任意終了（結果画面へ）

### 3. 結果/終了画面

- **表示情報**：未出枚数、読んだ枚数、総枚数

**リセットボタン：**
- **同じ範囲でやり直す**：範囲設定はそのまま、未出札リストのみリセット
- **Home画面に戻る**：設定画面に戻る

※いずれも確認ダイアログが表示されます

---

## 開発者向け情報

以下はローカル環境で開発・動作確認を行うための手順です。

### 必要環境

- Python 3.x
- モダンブラウザ（Chrome, Safari, Edgeなど）

### セットアップ手順

1. **Excel → JSON変換**
   プロジェクトルートで以下のコマンドを実行し、Excelデータ（260111geminiOCR.xlsx）をJSON形式に変換します。
   ```bash
   pip install openpyxl
   python convert_xlsx_to_json.py
   ```
   実行後、`public/cards.json`が生成されます。

2. **ローカルサーバーの起動**
   ```bash
   python -m http.server 5500
   ```

3. **ブラウザでアクセス**
   http://localhost:5500

## 仕様詳細

### データ

- Excel形式（260111geminiOCR.xlsx）を同梱
- 100件の札データ
  - A列：大ピンチレベル（数値）
  - B列：頭文字（1文字）
  - C列：内容（読み札の文章）

### 出題ロジック

- 選択範囲内から重複なしランダム出題
- 全札消化で自動終了
- 途中終了も可能

### バリデーション

- 範囲：1〜100のみ
- 開始番号 ≤ 終了番号
- 範囲外・逆順はエラー表示

## トラブルシューティング

### 音声が出ない場合

- iPhoneのサイレントモードを解除
- 音量を上げる
- Safariの権限を確認

### iPhoneから接続できない場合

- PC/MacとiPhoneが同じWi-Fiに接続されているか確認
- ファイアウォール設定を確認（ポート8000を開放）
- HTTPサーバーが起動しているか確認

### 読み上げが途切れる場合

- ネットワーク状況を確認（オフラインでも動作しますが、初回ロード時は必要）
- ブラウザのバックグラウンド実行制限を確認

## 技術スタック

- **バックエンド変換**: Python 3 + openpyxl
- **フロントエンド**: HTML5 + CSS3 + Vanilla JavaScript
- **音声合成**: Web Speech API (SpeechSynthesis)
- **配信**: Python HTTP Server

## ファイル構成

```
.
├── 260111geminiOCR.xlsx           # 元データ（Excel）
├── convert_xlsx_to_json.py        # Excel→JSON変換スクリプト
├── public/
│   └── cards.json                 # 変換後のJSONデータ
├── index.html                     # メインHTML
├── app.js                         # アプリケーションロジック
├── style.css                      # スタイルシート
└── README.md                      # このファイル
```

## ライセンス

個人利用・練習用途でご自由にお使いください。
